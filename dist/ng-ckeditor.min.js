/*
 * autor: Miller Augusto S. Martins
 * e-mail: miller.augusto@gmail.com
 * github: miamarti
 * */
(function(l,m){angular.module("ng.ckeditor",["ng"]).directive("ngCkeditor",function(){CKEDITOR.on("instanceCreated",function(a){var c=a.editor;if("simpleEditor"==c.element.getAttribute("class"))c.on("configLoaded",function(){c.config.removePlugins="colorbutton,find,flash,font, forms,iframe,image,newpage,removeformat, smiley,specialchar,stylescombo,templates";c.removeButtons="About";c.config.toolbarGroups=[{name:"editing",groups:["basicstyles","links"]},{name:"undo"},{name:"clipboard",groups:["selection",
"clipboard"]}]})});return{restrict:"E",scope:{ngModel:"=ngModel",ngChange:"=ngChange",ngDisabled:"=ngDisabled",ngConfig:"=ngConfig"},link:function(a,c,b){c[0].innerHTML='<div class="ng-ckeditor"></div> <div class="totalTypedCharacters"></div>';var g=c[0].querySelectorAll(".ng-ckeditor"),d={removeButtons:void 0!=b.removeButtons?"About,"+b.removeButtons:"About",readOnly:a.ngDisabled?a.ngDisabled:!1};void 0!=b.removePlugins&&(d.removePlugins=b.removePlugins);void 0!=b.skin&&(d.skin=b.skin);void 0!=b.width&&
(d.width=b.width);void 0!=b.height&&(d.height=b.height);void 0!=b.resizeEnabled&&(d.resize_enabled="false"==b.resizeEnabled?!1:!0);var f=CKEDITOR.appendTo(g[0],a.ngConfig?a.ngConfig:d,""),h=function(e){e.on("change",function(e){a.$apply(function(){a.ngModel=e.editor.getData()});void 0!=b.msnCount&&(element[0].querySelector(".totalTypedCharacters").innerHTML=b.msnCount+" "+e.editor.getData().length);a.ngChange&&"function"===typeof a.ngChange&&a.ngChange(e.editor.getData())});e.on("focus",function(b){e.setData(a.ngModel)})},
k=function(a,b){setTimeout(function(){a&&b?b.setData(a):b&&b.setData("")},500)};h(f);a.$watch("ngModel",function(a){k(a,f)});a.$watch("ngDisabled",function(b){d.readOnly=b?!0:!1;f.destroy();f=CKEDITOR.appendTo(g[0],a.ngConfig?a.ngConfig:d,"");h(f);f.setData(a.ngModel)})}}})})(window,document);
